<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tiered Pricing Calculator</title>
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<style>
  body { font-family:'Open Sans',sans-serif; margin:20px; background:#f7f7f7 }
  input, button { width:100%; padding:8px; margin:5px 0; font-size:16px; border:1px solid #ccc; border-radius:4px }
  button { background:#4285F4; color:white; border:none; cursor:pointer }
  button:hover { background:#357ae8 }
  .result { background:#fff; padding:15px; margin-top:20px; border-radius:4px; box-shadow:0 2px 4px rgba(0,0,0,.1) }
  h2 { color:#4285F4 }
  label { font-weight:bold }
</style>
</head>
<body>
  <h2>Tiered Pricing Calculator</h2>
  <label for="cost">Project Cost ($):</label>
  <input type="text" id="cost" placeholder="e.g. 15000" inputmode="numeric">

  <label for="multiplier">Minimum Multiplier (× cost):</label>
  <input type="text" id="multiplier" placeholder="e.g. 1.4" inputmode="numeric">

  <button id="calcBtn">Calculate Price</button>

  <div id="results" class="result"></div>

<script>
function format(n){
  return Number(n).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});
}
function parse(id){
  let v=document.getElementById(id).value.replace(/,/g,'');
  return parseFloat(v)||0;
}

function calculate(){
  const cost = parse('cost'),
        mult = parse('multiplier'),
        discounts = [0.05,0.10,0.07,0.03,0.02];

  if(cost<=0||mult<=0){
    return document.getElementById('results').innerHTML='<p>Please enter valid cost & multiplier.</p>';
  }

  const finalNet = cost * mult;
  // Compute starting price so final tier = cost×multiplier
  const totalFactor = discounts.reduce((acc,d)=>acc*(1-d), 1);
  let price = finalNet / totalFactor;

  let html = `<h3>Results</h3><table style="width:100%;border-collapse:collapse">
    <tr><td style="padding:8px">Tier 0 (No Discount)</td><td style="text-align:right;padding:8px">$${format(price)}</td></tr>`;

  discounts.forEach(d=>{
    price *= (1 - d);
    html += `<tr><td style="padding:8px">After ${(d*100).toFixed(0)}% Discount</td>
             <td style="text-align:right;padding:8px">$${format(price)}</td></tr>`;
  });

  html += '</table>';
  document.getElementById('results').innerHTML = html;
}

document.getElementById('calcBtn').addEventListener('click', calculate);

// Comma-format inputs
['cost','multiplier'].forEach(id=>{
  const el=document.getElementById(id);
  el.addEventListener('focus', ()=>el.value=el.value.replace(/,/g,''));
  el.addEventListener('blur', ()=>{
    const n=parseFloat(el.value.replace(/,/g,''))||0;
    if(n) el.value = format(n);
  });
});
</script>
</body>
</html>
